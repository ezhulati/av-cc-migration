---
/**
 * Destination Page - Uses shared ArticleLayout
 * All styling and structure comes from ArticleLayout.astro
 */

import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const destinations = await getCollection('destinations', ({ data }) => {
    return data && (!data.language || data.language === 'en');
  });

  return destinations.map(destination => ({
    params: { slug: destination.slug },
    props: { destination },
  }));
}

interface Props {
  destination: CollectionEntry<'destinations'>;
}

const { destination } = Astro.props;
const { Content } = await destination.render();

const {
  title,
  description,
  region,
  featuredImage,
  images,
  highlights,
  language,
} = destination.data;

const slug = destination.slug;

// Build breadcrumbs
const breadcrumbs = [
  { label: 'Home', href: '/' },
  { label: 'Destinations', href: '/destinations/' },
];
if (region) {
  breadcrumbs.push({ label: region, href: `/destinations/?region=${encodeURIComponent(region)}` });
}

// Build sidebar info items
const infoItems = [
  region && { icon: 'üìç', label: 'Region', value: region },
  { icon: 'üá¶üá±', label: 'Country', value: 'Albania' },
  { icon: 'üí¨', label: 'Language', value: 'Albanian, English' },
  { icon: 'üíµ', label: 'Currency', value: 'Albanian Lek (ALL)' },
].filter((item): item is { icon: string; label: string; value: string } => Boolean(item));

// Navigation links
const navigationLinks = [
  { label: '‚Üê All Destinations', href: '/destinations/' },
  { label: 'Top Attractions', href: '/attractions/' },
  { label: 'Activities & Tours', href: '/activities/' },
];
---

<ArticleLayout
  title={`${title} - Albania Destination Guide`}
  description={description}
  canonical={`https://albaniavisit.com/destinations/${slug}/`}
  image={featuredImage}
  language={language}
  heroTitle={title}
  heroSubtitle={description}
  featuredImage={featuredImage}
  breadcrumbs={breadcrumbs}
  infoItems={infoItems}
  highlights={highlights}
  images={images}
  navigationLinks={navigationLinks}
  contentType="destination"
>
  <Content />
</ArticleLayout>
