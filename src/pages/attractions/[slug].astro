---
/**
 * Attraction Page - Uses shared ArticleLayout
 * All styling and structure comes from ArticleLayout.astro
 */

import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const attractions = await getCollection('attractions', ({ data }) => {
    return data && (!data.language || data.language === 'en');
  });

  return attractions.map(attraction => ({
    params: { slug: attraction.slug },
    props: { attraction },
  }));
}

interface Props {
  attraction: CollectionEntry<'attractions'>;
}

const { attraction } = Astro.props;
const { Content } = await attraction.render();

const {
  title,
  description,
  type,
  location,
  featuredImage,
  images,
  highlights,
  essence,
  entryFee,
  hours,
  timeNeeded,
  bestSeason,
  language,
} = attraction.data;

const slug = attraction.slug;

// Build breadcrumbs
const breadcrumbs = [
  { label: 'Home', href: '/' },
  { label: 'Attractions', href: '/attractions/' },
];
if (type) {
  breadcrumbs.push({ label: type });
}

// Build sidebar info items
const infoItems = [
  location && { icon: 'ğŸ“', label: 'Location', value: location },
  entryFee && { icon: 'ğŸ’°', label: 'Entry Fee', value: entryFee },
  hours && { icon: 'ğŸ•', label: 'Hours', value: hours },
  timeNeeded && { icon: 'â±ï¸', label: 'Time Needed', value: timeNeeded },
  bestSeason && { icon: 'ğŸŒ¤ï¸', label: 'Best Season', value: bestSeason },
].filter(Boolean);

// Navigation links
const navigationLinks = [
  { label: 'â† All Attractions', href: '/attractions/' },
  { label: 'Destinations', href: '/destinations/' },
  { label: 'Activities & Tours', href: '/activities/' },
];
---

<ArticleLayout
  title={`${title} - Attractions in Albania`}
  description={description}
  canonical={`https://albaniavisit.com/attractions/${slug}/`}
  image={featuredImage}
  language={language}
  heroTitle={title}
  heroSubtitle={essence || description}
  featuredImage={featuredImage}
  breadcrumbs={breadcrumbs}
  infoItems={infoItems}
  highlights={highlights}
  images={images}
  navigationLinks={navigationLinks}
  contentType="attraction"
>
  <Content />
</ArticleLayout>
