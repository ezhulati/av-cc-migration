---
/**
 * Attraction Page - Uses shared ArticleLayout
 * All styling and structure comes from ArticleLayout.astro
 */

import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import ArticleLayout from '../../layouts/ArticleLayout.astro';

export async function getStaticPaths() {
  const attractions = await getCollection('attractions', ({ data }) => {
    return data && (!data.language || data.language === 'en');
  });

  return attractions.map(attraction => ({
    params: { slug: attraction.slug },
    props: { attraction },
  }));
}

interface Props {
  attraction: CollectionEntry<'attractions'>;
}

const { attraction } = Astro.props;
const { Content } = await attraction.render();

const {
  title,
  description,
  type,
  location,
  featuredImage,
  images,
  language,
} = attraction.data;

const slug = attraction.slug;

// Build breadcrumbs
const breadcrumbs = [
  { label: 'Home', href: '/' },
  { label: 'Attractions', href: '/attractions/' },
];
if (type) {
  breadcrumbs.push({ label: type, href: `/attractions/?type=${encodeURIComponent(type)}` });
}

// Build sidebar info items
const infoItems = [
  location && { icon: 'üìç', label: 'Location', value: location },
  type && { icon: 'üèõÔ∏è', label: 'Type', value: type },
  { icon: 'üá¶üá±', label: 'Country', value: 'Albania' },
].filter((item): item is { icon: string; label: string; value: string } => Boolean(item));

// Navigation links
const navigationLinks = [
  { label: '‚Üê All Attractions', href: '/attractions/' },
  { label: 'Destinations', href: '/destinations/' },
  { label: 'Activities & Tours', href: '/activities/' },
];
---

<ArticleLayout
  title={`${title} - Attractions in Albania`}
  description={description}
  canonical={`https://albaniavisit.com/attractions/${slug}/`}
  image={featuredImage}
  language={language}
  heroTitle={title}
  heroSubtitle={description}
  featuredImage={featuredImage}
  breadcrumbs={breadcrumbs}
  infoItems={infoItems}
  images={images}
  navigationLinks={navigationLinks}
  contentType="attraction"
>
  <Content />
</ArticleLayout>
