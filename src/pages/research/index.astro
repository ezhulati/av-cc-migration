---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// Get all published research reports
const allResearch = await getCollection('research', ({ data }) => {
  return data.status === 'publish' && data.language === 'en';
});

// Sort by date (newest first)
const sortedResearch = allResearch.sort((a, b) =>
  new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
);
---

<BaseLayout
  title="Research Reports Archive"
  description="In-depth reports on tourism trends, visitor behavior, and economic data related to travel in Albania, prepared by AlbaniaVisit.com"
  canonical="https://albaniavisit.com/research/"
>
  <div class="research-page">
    <!-- Hero Section -->
    <section class="research-hero">
      <div class="container">
        <h1>Research Reports</h1>
        <p class="hero-subtitle">
          In-depth reports on tourism trends, visitor behavior, and economic data related to travel in Albania, prepared by AlbaniaVisit.com
        </p>
        <div class="scroll-indicator">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5V19M12 19L19 12M12 19L5 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      </div>
    </section>

    <!-- Research Reports Grid -->
    <section class="research-grid-section">
      <div class="container">
        <div class="research-grid">
          {sortedResearch.map((report) => {
            const slug = report.id.replace(/\.md$/, '');
            return (
              <article class="research-card">
                {report.data.featuredImage && (
                  <a href={`/research/${slug}/`} class="research-card-image">
                    <img
                      src={report.data.featuredImage}
                      alt={report.data.title}
                      loading="lazy"
                    />
                  </a>
                )}
                <div class="research-card-content">
                  <h2 class="research-card-title">
                    <a href={`/research/${slug}/`}>{report.data.title}</a>
                  </h2>
                  <p class="research-card-description">{report.data.description}</p>
                  <a href={`/research/${slug}/`} class="research-card-button">
                    Read Report â†’
                  </a>
                </div>
              </article>
            );
          })}
        </div>
      </div>
    </section>
  </div>

  <style>
    .research-page {
      font-family: var(--font-sans);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Hero Section */
    .research-hero {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      color: white;
      padding: 5rem 0 4rem;
      text-align: center;
    }

    .research-hero h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      line-height: 1.2;
    }

    .hero-subtitle {
      font-size: 1.25rem;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.9);
      max-width: 800px;
      margin: 0 auto 2rem;
    }

    .scroll-indicator {
      margin-top: 2rem;
      color: rgba(255, 255, 255, 0.6);
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(10px); }
    }

    /* Research Grid Section */
    .research-grid-section {
      padding: 4rem 0;
      background: #f8f8f8;
    }

    .research-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 3rem;
      max-width: 900px;
      margin: 0 auto;
    }

    /* Research Card */
    .research-card {
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .research-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
    }

    .research-card-image {
      display: block;
      width: 100%;
      height: 400px;
      overflow: hidden;
    }

    .research-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .research-card:hover .research-card-image img {
      transform: scale(1.05);
    }

    .research-card-content {
      padding: 2rem;
    }

    .research-card-title {
      font-size: 1.75rem;
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: 1rem;
    }

    .research-card-title a {
      color: #1a1a1a;
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .research-card-title a:hover {
      color: #e41e20;
    }

    .research-card-description {
      font-size: 1rem;
      line-height: 1.7;
      color: #4a4a4a;
      margin-bottom: 1.5rem;
    }

    .research-card-button {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background: #e41e20;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: 600;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .research-card-button:hover {
      background: #c41a1c;
      transform: translateX(4px);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .research-hero h1 {
        font-size: 2.25rem;
      }

      .hero-subtitle {
        font-size: 1.125rem;
      }

      .research-card-image {
        height: 250px;
      }

      .research-card-content {
        padding: 1.5rem;
      }

      .research-card-title {
        font-size: 1.5rem;
      }
    }
  </style>
</BaseLayout>
